---
title: "Code Scratch"
author: "Alicia Rich"
date: "`r Sys.Date()`"
output: html_document
                     
---

```{r setup, include=FALSE}
library(devtools)
library(roxygen2)
```

```{r include=FALSE}
document()
```


```{r include=FALSE}
install()
```

```{r include=FALSE}
library(conflicted)
library(devtools)
library(DiagrammeR)
library(here)
library(igraph)
library(knitr)
library(magrittr)
library(pedtools)
library(roxygen2)
library(tidyverse)
library(visNetwork)
knitr::opts_chunk$set(
  collapse = TRUE,
  message  = FALSE,
  warning  = FALSE,
  echo     = TRUE,
  include  = TRUE,
  eval     = TRUE,
  comment  = ""
)
conflicts_prefer(lubridate::interval)
conflicts_prefer(dplyr::filter)
conflicts_prefer(purrr::set_names)
studbook <- read_csv(here("inst/extdata/studbook.csv"))
pedigree <- featured_pedigree(studbook)
```

```{r}
subnucs <- subnucs(pedigree)
births <- count_births(studbook)
```

```{r}
tree <- visPed_tree(studbook, pedigree)
```

```{r}
popline <- function(type) {
  list(
      color     = colors[[type]],
      shape     = "spline",
      smoothing = 0.8,
      width     = 1.5
  )
}
```


```{r}
census_df <- census(studbook, "years") %>%
    rowwise() %>%
    mutate(Total = sum(Males, Females, Unidentified))
plot <- plot_ly(census_df,
                x          = ~Date,
                y          = ~Unidentified,
                name       = "Sex Unidentified",
                type       = "scatter",
                mode       = "lines",
                stackgroup = "one",
                hoveron    = "points+fills",
                opacity    = 0.5,
                line       = popline("u"),
                fillcolor  = fill.col[["u"]]) %>%
  add_trace(y         = ~Females,
            name      = "Females",
            line      = popline("f"),
            fillcolor = fill.col[["f"]]) %>%
  add_trace(y         = ~Males,
            name      = "Males",
            yaxis     = "y2",
            line      = popline("m"),
            fillcolor = fill.col[["m"]]) %>%
  layout(title        = title,
         plot_bgcolor = "#ffffff",
         yaxis2       = list(
           overlaying = "y",
           side       = "right",
           title      = "N Males"
         ),
         yaxis        = list(
           type      = "linear",
           autorange = TRUE,
           title     = "N Total, Females, & Unidentified",
           showline  = TRUE,
           showgrid  = FALSE
         ),
         xaxis         = list(
           title       = "Date",
           showline    = FALSE,
           showgrid    = TRUE,
           rangeslider = list(visible = TRUE)
         )
  )

```



